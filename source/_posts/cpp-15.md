---
title:  C++内存分配
date: 2019-12-14 22:52:29
tags: [C++]
categories: [技术分享]
---

C/C++编译的程序占用的内存和大端存储 小端存储

<!--more-->

**内存分配**

C++中内存管理


|                                                          |
| -------------------------------------------------------- |
| 内核空间                                                 |
| 栈(向低地址空间增长)                                     |
| 映射区                                                   |
| 堆(向高地址空间增长)                                     |
| BSS段  (全局静态存储区) 存储未初始化的全局变量和静态变量 |
| 数据段 (全局静态存储区) 存储初始化的全局变量和静态变量   |
| 代码段 (文字常量区+文本区)                               |

动态空间

栈：存储函数的返回地址、参数、局部变量、返回值，从高地址向低地址增长。

堆：当进程未调用malloc时是没有堆段的，只有调用malloc时采用分配一个堆，并且在程序运行过程中可以动态增加堆大小(移动break指针)，从低地址向高地址增长。分配小内存时使用该区域。

**映射区**：存储动态链接库等文件映射、申请大内存（malloc时调用mmap函数）


静态空间：

BSS段：存储**未初始化的全局变量和静态变量（局部+全局）**，**以及所有被初始化为0的全局变量和静态变量**，对于未初始化的全局变量和静态变量，程序运行main之前时会统一清零。即未初始化的全局变量编译器会初始化为0

数据段：存储程序中**已初始化的全局变量和静态变量**


代码段:包括**只读存储区**和**文本区**，其中**只读存储区存储字符串常量**，**文本区存储程序的机器代码**。


**大端小端存储**


大端：
小端：低位进低地

```
unsigned int n=0x1234;
char b = *(unsigned char *)&a;

printf("%x",b);  //windows输出34  小端存储的
```




2019-10-12 23:49:56 星期六