---
title: Linux（学习shell）
date: 2020-01-08 21:27:57
tags: [Linux]
categories: [学习笔记]
---

 一个好的命令行界面是一种很神奇的人机交互方式

<!--more-->

1. KISS:eep it simple，stupid
1. Everything is a file
1. Do one thing and do it well
1. Except the output of one program to be the input to another

这四句叫Linux Philosophy，很神奇哈

**linux文件**：‘.’字符开始的文件是隐藏文件；文件名区分大小写，没有文件扩展名概念，文件名可以使用句号、连字符、下划线,大小写敏感，File file为不同的文件。

linux命令分为：

- shell内置命令
- shell函数
- alias命令
- 可执行文件


### 命令是什么

shell来自于称之为bash的GNU项目，bash就是Bourne Again Shell
shell提示符 username@machinename 后面是工作目录和$符

绝对路径：从根目录开始
相对路径：从当前工作目录开始
‘.’:代表工作目录
‘..’:代表工作目录的父目录



**硬链接**：和文件本身无区别，删硬链接，文件正常，删文件，硬链接正常，

**符号链接**：类似windows快捷方式，删符号链接，文件正常，删文件，符号链接损坏

（操作系统中）
硬链接：硬链接指通过索引节点来进行连接。在Linux的文件系统中，保存在磁盘分区中的文件不管是什么类型都给它分配一个编号，称为索引节点号(Inode Index)。在Linux中，多个文件名指向同一索引节点是存在的。一般这种连接就是硬连接。硬连接的作用是允许一个文件拥有多个有效路径名，这样用户就可以建立硬连接到重要文件，以防止“误删”的功能。其原因如上所述，因为对应该目录的索引节点有一个以上的连接。只删除一个连接并不影响索引节点本身和其它的连接，只有当最后一个连接被删除后，文件的数据块及目录的连接才会被释放。也就是说，文件真正删除的条件是与之相关的所有硬连接文件均被删除。

在用户的目录中设置指向共享文件的索引结点指针，此时由任何用户对共享文件进行改变，都将引起其相应结点内容的改变。

符号链接：由系统为创建一个link类型的新文件，取名和共享文件名一样，在新文件中只包含共享文件的路径名

ls -l 命令 ，以长格式显示结果

| 字段              | 含义                                                         |
| ----------------- | ------------------------------------------------------------ |
| -rw-r--r--        | 第一个字符表示文件类型，剩下的三个一组，第一组表示文件所有者的访问权限，第二组表示文件所属组成员的访问权限，第三组表示其他所有人的访问权限 |
| 1                 | 文件的硬链接数目                                             |
| root              | 文件所有者的用户名                                           |
| root              | 文件所属群组的名称                                           |
| 32059             | 文件大小字节数                                               |
| 2018-04-03 11：05 | 上次修改文件的日期时间                                       |
| a.txt             | 文件名                                                       |

### 重定向

```
>   从文件开头部分重新改写
<   把标准输入的源从键盘变为某个文件
>>  追加到文件尾部

```

|                | 文件描述符 | 默认 |
| -------------- | ---------- | ---- |
| 标准输入stdin  | 0          | 键盘 |
| 标准输出stdout | 1          | 屏幕 |
| 标准错误stderr | 2          | 屏幕 |

标准错误重定向

```
ls -l /bin 2 > out.txt
```

标准输出和标准错误都重定向

```
ls -l /bin  > out.txt 2>&1  //首先重定向标准输出到out.txt，然后使用标记 2>&1把文件描述符2（标准错误）重定向到文件描述符1（标准输出）中
```

**管道**：管道操作符‘|’ ，将一个命令的标准输出传送到另一个命令的标准输入

过滤器：对输入进行改变




| 通配符        | 含义                               |
| ------------- | ---------------------------------- |
| *             | 匹配任意多个字符                   |
| ?             | 匹配任一单个字符                   |
| [characters]  | 匹配任意一个属于字符集中的字符     |
| [!characters] | 匹配任意一个不属于字符集中的字符   |
| [[:class:]]   | 匹配任意一个属于指定字符类中的字符 |

#### 常用字符类

| 字符类    | 含义                   |
| --------- | ---------------------- |
| [:alnum:] | 匹配任意一个字母或数字 |
| [:alpha:] | 匹配任意一个字母       |
| [:digit]  | 匹配任意一个数字       |
| [:lower:] | 匹配任意一个小写字母   |
| [:upper:] | 匹配任意一个大写字母   |


#### 扩展：

路径名扩展：echo lab*
波浪线扩展： ~被指定为用户的主目录名  echo ~  输出/home/me
算术扩展：  $((2+2))  中间是算术表达式    $((expression))    expression是包含数值和算术操作符的算术表达式（+ - * / % **）
花括号扩展： {A,B,C}  {A..Z} 
参数扩展：   $USER 变量包含了用户名
命令替换：   echo $(ls)   【将一个命令的输出作为一个扩展模式使用】



双引号：在双引号中的特殊字符失去含义，除了美元符号"$",反斜杠"\\",反引号“'”不扩展
单引号：单引号抑制所有扩展，都会失去特殊含义
转义字符：想要引用单个字符，或者消除字符串中某个字符的特殊含义。转义字符经常出现在双引号中用来有选择性的阻止扩展。echo “the sum is \\$5.00”   输出:the sum is $5.00   【阻止了$5的扩展】



------

## 快捷键

**光标移动**

| 组合键 | 作用                                |
| ------ | ----------------------------------- |
| ctrl A | 移动到行首                          |
| ctrl E | 移动到行尾                          |
| ctrl F | 光标向前移动一个字符，右箭头键      |
| ctrl B | 光标向后移动一个字符，左箭头键      |
| alt F  | 光标向前移动一个字                  |
| alt B  | 光标向后移动一个字                  |
| ctrl L | 清屏并把光标移到左上角，和clear一样 |



**修改文本**

| 组合键 | 作用                                 |
| ------ | ------------------------------------ |
| ctrl D | 删除光标处的字符                     |
| ctrl T | 使光标处的字符和它前面的字符对调位置 |
| alt T  | 光标处的字 和它前面的字对调位置      |
| alt L  | 从光标到字尾的字符转换成小写字母格式 |
| alt U  | 从光标到字尾的字符转换成大写字母格式 |



**剪切和粘贴文本**

| 组合键        | 作用                                    |
| ------------- | --------------------------------------- |
| ctrl K        | 剪切从光标到行尾的文本                  |
| ctrl U        | 剪切从光标到行首的文本                  |
| alt D         | 剪切从光标到当前词尾的文本              |
| alt Backspace | 剪切从光标到词头的文本                  |
| ctrl Y        | 把kill-ring缓冲区中的文本粘贴到光标位置 |



tab键触发自动补齐




## 权限

相对来说比较重要的一章



UNIX操作系统不仅是多任务系统，还是多用户系统



所有者：一个用户可以拥有文件和目录，对拥有的文件和目录的访问权限具有控制权
组成员：用户又归属于一个群组，该群组由一个或多个用户组成
其他所有用户：所有用户指的整个世界，其他所有用户指的不是上面的其他用户

当创建用户账户时，用户将被分配一个用户id，uid，同时被分配一个有效组id，gid

#### 文件类型

| 属性 | 含义         |
| ---- | ------------ |
| -    | 普通文件     |
| d    | 目录文件     |
| l    | 符号链接     |
| c    | 字符设备文件 |
| b    | 块设备文件   |

#### 权限属性

| 属性 | 含义                                                         |
| ---- | ------------------------------------------------------------ |
| r    | 允许打开和读取文件                                           |
| w    | 允许写入和截断文件，如果也设置了执行权限，那么目录中的文件允许被创建被删除以及被重命名 |
| x    | 允许把文件当做程序一样被执行                                 |

**chmod**

chmod number file
八进制数字表示法：---对应000；rwx对应111
符号表示法：u，g，o，a，对应user，group，others，all
r，w，x对应读，写，执行



**chown**

chown owner:group file

#### 更改文件所有者和所属群组

| 参数      | 含义                                                     |
| --------- | -------------------------------------------------------- |
| bob       | 把文件所有者更改为bob                                    |
| bob:users | 文件所有者更改为bob，所属群组更改为users                 |
| :admins   | 所属群组改为admin，所有者不变                            |
| bob:      | 文件所有者更改为bob，所属群组改为bob登录系统时所属的群组 |

**chgrp**

#### 更改文件所属群组

早起chown命令只能更改文件所有者不能改变文件所属群组，所以增加了chgrp命令

**umask**

设置默认权限，执行umask命令，输出当前掩码值，再设置掩码值，便会修改文件权限

**更改身份**

- 注销系统并且以其他用户的身份重新登录系统
- su
- sudo

su命令用来以另一个用户的是身份启动shell
su -l user 则是用于指定用户的登录shell
su -   则是使用超级用户的身份登录shell，需要输入超级用户的密码

也可以使用su -c ‘command’  执行单条命令

sudo命令允许一个普通用户以一个不同的用户身份执行命令，使用sudo命令不需要输入超级用户的密码，只需要输入自己的密码
sudo命令不需要启动一个新的shell环境，也不需要加载另一个用户的运行环境

## 进程

每个进程将被分配一个进程id



|  参数   |                    含义                    |
| :-----: | :----------------------------------------: |
|   ps    |     显示进程运行pid，时间，以及程序名      |
|  ps x   |      显示所有的进程，不管是哪个终端的      |
| ps  aux | 显示更多的信息，显示属于每个用户的进程信息 |

top 以列表的形式持续更新显示系统进程的当前信息，默认3秒更新一次，按CPU活动时间排序

#### ps x STAT列状态

| 状态 | 含义                                                         |
| ---- | ------------------------------------------------------------ |
| R    | 运行状态，进程正在运行或准备运行                             |
| S    | 睡眠状态                                                     |
| D    | 不可中断的睡眠状态，进程在等待I/O操作，如硬盘驱动            |
| T    | 暂停状态                                                     |
| Z    | 无效或者“僵尸进程”，子进程被终止，但是还没有被其父进程彻底释放掉 |
| <    | 高级优先进程                                                 |
| N    | 低级优先进程                                                 |



#### ps aux 标题

| 标题  | 含义                   |
| ----- | ---------------------- |
| USER  | 用户ID，该进程的所有者 |
| %CPU  | CPU使用百分比          |
| %MEM  | 内存使用百分比         |
| VSZ   | 虚拟好用内存大小       |
| RSS   | 实际使用的内存大小     |
| START | 进程开启的时间         |



**kill 发送信号**

| 信号编号 | 信号名 | 含义                               |
| -------- | ------ | ---------------------------------- |
| 1        | HUP    | 挂起信号                           |
| 2        | INT    | 中断信号                           |
| 9        | KILL   | 杀死信号                           |
| 15       | TERM   | 终止信号                           |
| 18       | CONT   | 继续运行信号                       |
| 19       | STOP   | 暂停信号                           |
| 3        | QUIT   | 退出信号                           |
| 11       | SEGV   | 段错误信号，程序非法使用了内存空间 |
| 20       | TSTP   | 终端暂停信号                       |
| 28       | WINCH  | 窗口改变信号                       |



**killall发送信号**

killall -u user [-singal]  name

可以给指定程序或指定用户名的多个用户发送信号

| 比较   |                                                    |
| ------ | -------------------------------------------------- |
| 图形化 | 命令行                                             |
|        | 运行的程序不在窗口管理器菜单中                     |
|        | 从图形化启动错误，从命令行启动会看到更多的错误信息 |





------






| 命令大全            | 含义                                             | 示例                                                         |
| ------------------- | ------------------------------------------------ | ------------------------------------------------------------ |
| **常用 **           |                                                  |                                                              |
| date                | 显示当前系统时间日期                             |                                                              |
| cal                 | 显示日历                                         |                                                              |
| df                  | 显示当前磁盘驱动器的可用空间                     |                                                              |
| free                | 显示可用内存                                     |                                                              |
| exit                | 退出终端会话                                     |                                                              |
| pwd                 | 显示当前工作目录                                 |                                                              |
| ls                  | 列出当前工作目录的文件和目录                     | ls -l  以长格式输出                                          |
| ** 操作文件与目录** |                                                  |                                                              |
| cd                  | 改变工作目录                                     |                                                              |
| file                | 确定文件类型                                     | file contents.txt                                            |
| less                | 查看文件内容                                     | less contents.txt                                            |
| cp                  | 复制文件和目录                                   |                                                              |
| mv                  | 移动或重命名文件和目录                           | mv a b;a文件重命名为b                                        |
| mkdir               | 创建目录                                         |                                                              |
| touch               | 创建文件                                         |                                                              |
| rm                  | 删除文件或目录                                   |                                                              |
| ln                  | 创建硬链接和符号链接                             | ln a b；创建硬链接                       ln -s a b;创建软链接  。 硬链接不能为目录创建；软链接可以为目录和文件创建 |
| **命令的使用**      |                                                  |                                                              |
| type                | 显示命令的类型                                   | type type；输出type is a shell builtin(type是一个shell内置命令) |
| which               | 显示可执行程序的位置                             | which ls；输出/bin/ls                                        |
| help                | 获得命令的帮助文档                               | help cd；                                                    |
| man                 | 显示命令的使用手册                               | man ls；(man 调用less 命令来显示手册文档)                    |
| apropos             | 显示合适的命令                                   | apropos ls；                                                 |
| whatis              | 显示命令的简要描述                               | whatis ls;输出 list directory contents                       |
| info                | 显示命令的info条目                               |                                                              |
| alias               | 创建一条命令的别名                               | alias foo = "ls -l"(shell 会话结束时，这些别名也随之消失了)  |
| unalias             | 删除别名                                         |                                                              |
| **重定向**          |                                                  |                                                              |
| cat                 | 合并文件                                         | cat 命令读取一个或多个文件，并把它们赋值到标准输出文件中。在缺少文件名的情况下，cat将标准输入内容复制到标准输出文件中；cat > a ;cat < a |
| sort                | 对文本行进行排序                                 | ls -l \| sort                                                |
| uniq                | 报告或删除文件中重复的行                         | ls -l \|sort \| uniq                                         |
| wc                  | 打印文件中的换行符、字、字节的个数               | wc a;输出 6 6 32 a   (换行符6个   6个字  32个字节【6个换行符+26字母】) |
| grep                | 匹配行                                           | cat a \| grep aaa                                            |
| head                | 打印文件的开头部分                               | head -n 2 a                                                  |
| tail                | 打印文件的末尾部分内容                           | tail -n 2 a                                                  |
| tee                 | 从stdin读取数据，并同时输出到stdout和文件        | cat a \| tee b                                               |
| echo                | 显示一行文本                                     |                                                              |
| clear               | 清屏                                             |                                                              |
| history             | 显示历史列表的记录                               |                                                              |
| **权限**            |                                                  |                                                              |
| id                  | 显示用户身份标识                                 |                                                              |
| passwd              | 更改用户密码                                     |                                                              |
| umask               | 设置文件的默认权限                               |                                                              |
| su                  | 以另一个用户的身份运行shell                      |                                                              |
| sudo                | 以另一个用户的身份执行命令                       |                                                              |
| chmod               | 更改文件模式                                     |                                                              |
| chown               | 更改文件所有者                                   |                                                              |
| chgrp               | 更改文件所属群组                                 |                                                              |
| **进程**            |                                                  |                                                              |
| ps                  | 显示当前所有进程的运行情况                       | ps x显示所有进程；                                           |
| top                 | 实时显示当前所有任务的资源占用情况               |                                                              |
| jobs                | 列出所有活动作业的状态信息                       |                                                              |
| bg                  | 设置在后台运行作业                               |                                                              |
| fg                  | 设置在前台运行作业                               |                                                              |
| kill                | 发送信号给某个进程                               |                                                              |
| killall             | 杀死指定名字的进程                               |                                                              |
| shutdown            | 关机或者重启系统                                 |                                                              |
| pstree              | 以进程树的形式输出进程列表，展示进程间的父子关系 |                                                              |





------







*2019-05-01 17:16:40 星期三
萧逸小杨*