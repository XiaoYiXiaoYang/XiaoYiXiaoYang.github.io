---
title: 操作系统复习（存储管理）
date: 2019-12-22 19:25:10
tags: [操作系统]
categories: [学习笔记]
---



储器历来是计算机系统的重要组成部分、存储器层次

<!--more-->

**多层次结构的存储器系统**



|     寄存器     |
| :------------: |
|    高速缓存    |
|    主存储器    |
|    磁盘缓存    |
|    固定磁盘    |
| 可移动存储介质 |



**程序的装入**

由装入程序

- 绝对装入方式

用户程序编译后即产生绝对地址

- 可重定位装入方式

在装入时对目标程序中指令和数据地址的修改过程

- 动态运行时装入方式

将地址转换推迟到程序执行时才真正执行



**程序的链接**

- 静态链接方式

将各目标模块及他们所需的库函数链接成一个完整的装配模块

- 装入时动态链接

在装入一个目标模块时，若发生一个外部调用事件，将引起装入程序去寻找相应的外部模块，并将它装入内存

- 运行时动态链接

执行过程中，当发现一个被调用模块尚未装入内存时，立即由OS去寻找该模块，并将之装入内存，将其链接到调用者模块上



**连续分配存储管理**

为一个用户程序分配一个连续的内存空间

- 单一连续分配

系统区提供给OS使用，用户区中，仅装有一道用户程序，即整个内存的用户空间由该程序独占

- 固定分区分配

将用户空间划分为若干固定大小的区域，每个分区只装入一道作业

分区大小相等

分区大小不等

内存分配（分区使用表）

| 分区号 | 大小 | 起址 | 状态   |
| ------ | ---- | ---- | ------ |
| 1      | 12   | 20   | 已分配 |
| 2      | 32   | 32   | 已分配 |


- 动态分区分配

空闲分区表

空闲分区链



**基于顺序搜索的动态分区分配算法**

首次适应算法 （First Fit）

循环首次适应算法 （Next Fit）

最佳适应 （Best Fit）

最坏适应 （Worst Fit）



**基于索引搜索的动态分区分配算法**

快速适应算法 （Quick Fit）

伙伴系统 （Buddy System）

哈希算法 （Hash）



**回收内存**

回收区邻接F1

回收区邻接F2

回收区邻接F1 F2

回收区不邻接F1 F2



**紧凑**

将内存中的所有作业今次那个移动，使他们相邻接，即可把原来分散的多个空闲小分区拼接成一个大分区



**对换**

把内存中暂时不能运行的进程或者暂时不用的程序和数据换出到外存上，以便腾出足够的内存空间，再把已具有运行条件的进程或进程需要的程序和数据换入内存


进程的换出

选择换出进程：选择处于阻塞状态或睡眠状态的进程，当有多个这样的进程，应该选择优先级最低的进程作为换出进程

换出过程：申请对换空间，申请成功就启动磁盘，将该进程的程序和数据传送到磁盘的兑换区上

进程的换入

选择换入进程：选择“就绪”状态的进程，

换入过程：启动对换程序，将换入进程换入



**分页存储**

| 页号  | 位移量  |
| ------------ | ------------ |


页表

| 页号  | 块号  |
| ------------ | ------------ |



地址变换机构

有效访问时间：进程从逻辑地址出发，经过地址变换，到在内存中找到实际的物理地址单元并取出数据，称为内存的有效访问时间

假设访问一次内存时间t

分页系统访问时间: t + t = 2t
查找页表对应的页表项耗费的时间t
将页表项中的物理块号与页内地址拼接成实际物理地址所耗费的时间



**分段存储**


| 段号  | 段内地址  |
| ------------ | ------------ |

段表

| 段号 | 段长 |  基址 |
|---------| ------------ | ------------ |

地址变换机构


**信息共享**

160kb代码和40kb数据


分页系统

分段系统


**局部性原理**

时间局部性

空间局部性



**虚拟存储器特征**

多次性

对换性

虚拟性



**请求分页系统**

- 缺页中断机构

在指令执行期期间产生和处理中断信号

一条指令在执行期间可能产生多次缺页中断


- 请求调页

页表格式

| 页号  | 块号  | 状态位 | 访问字段 | 修改位 |  外存地址 |
| ------------ | ------------ |

- 请求调页内存分配

最小物理块数：进程运行时需要的最小物理块数

固定分配：为每个进程分配固定数目的物理块

可变分配：为每个进程分配一定数目的物理块

局部置换：在进程运行时发现缺页，则只能从分配给该进程的n个页面中选出一页换出，然后再调入一页

全局置换：如果进程运行时发现缺页，则将OS所保留的空闲物理块取出一块分配给该进程


固定分配局部置换

可变分配全局置换

可变分配局部置换



**物理块分配算法**

平均分配算法

按比例分配算法

考虑优先权的分配算法



**缺页率**

访问页面成功次数S
访问页面失败次数F

缺页率：S/S+F



**页面置换算法**

最佳置换算法（OPT）

先进先出算法（FIFO）

最近最久未使用算法 （LRU）

最少使用算法（LFU）

Clock置换算法（未使用0 就将该页换出，1就将它置0，给一次驻留内存机会）

改进Clock算法（既是未使用，也要未修改）

```
访问位A=0   修改位M=0
访问位A=0   修改位M=1
访问位A=1   修改位M=0
访问位A=1   修改位M=1

扫描第一种页面，如果失败找第二种
```

页面缓冲算法（PBA）



**抖动**

系统中运行的进程太多，导致每个进程分配的物理块太少，导致频繁缺页，大部分时间在换入/换出，处理机利用率急剧下降

**工作集**

在某段时间间隔内，进程实际要访问的页面的集合





2019-07-03 16:36:32 星期三