---
title: C++对象模型(Function语意学)
date: 2019-12-14 10:53:47
tags: [C++对象模型]
categories: [学习笔记]
---



static 、nonstatic、virtual

<!--more-->



```
Point obj;
Point *pt = &obj;

obj.foo();
pt->foo();
```



#### 成员函数的各种调用方式



**nonstatic 成员函数**

准则：nonstatic成员函数和一般的函数有相同的效率



1.改写成员函数，安插this指针到成员函数中去

2.将每一个对nonstatic数据成员的存取改为经由this指针来存取

3.将成员函数重新写成一个外部函数，函数名处理一下



**虚成员函数**



```
ptr->foo()

(*ptr->vptr[1])(ptr);
```

vptr表示由编译器产生的指针，指向虚函数表

1是虚函数表的索引，找到foo函数地址

参数ptr表示this指针



**static成员函数**



独立于类对象之外的存取操作，程序方法上的解决之道是把0强制转换为一个类指针

foo((Point3d *) 0);



static成员函数没有this指针，

它不能直接存取类中的nonstatic成员，

它不能被声明为const

它不需要经由类对象才被调用



#### 虚成员函数



ptr->foo()

需要知道

1.ptr所指对象的真实类型

2.foo()函数的真实实例



1.为了找到该表格，每一个类对象被安插了一个由编译器内部产生的指针

2.为了找到函数地址，每一个虚函数被指派一个表格索引值



**派生类的行为**

1.他可以继承基类声明的虚函数的实例，基类的虚函数实例会被拷贝到派生类的虚函数表的相应位置

2.它可以使用自己的函数实例

3.它可以加入新的虚函数你





**多重继承下的虚函数**



复杂度在第二个基类和之后的基类上







**虚拟继承下的虚函数**





